import{r as i,o as L,p as R,q as A,s as U,B as x,j as e,k as B}from"./index-c4e2cc73.js";import{u as D,c as _,a as u}from"./index.esm-2c90ee21.js";import{C as H}from"./Container-63baafe0.js";import{S as M}from"./Spinner-629879c1.js";import{C as j}from"./Card-9b483582.js";import{F as m}from"./FormControl-5cf87238.js";import{B as d}from"./Button-037f9f3f.js";import"./CardHeaderContext-1cd0ceea.js";import"./index-89cce2e6.js";import"./Button-cf2780f7.js";const X=()=>{const[C,f]=i.useState(!1),[o,g]=i.useState([]),{data:y}=L(),[v,{isSuccess:b,isError:V,isLoading:S}]=R(),[F,{isSuccess:N,isLoading:w}]=A(),[k,{isSuccess:P,isLoading:q}]=U(),[r,h]=i.useState(),[E,p]=i.useState([]),n=D({enableReinitialize:!0,initialValues:{name:r?r.name:"",price:r?r.price:"",desc:r?r.desc:"",hero:r?r.hero:"",qty:r?r.qty:""},validationSchema:_({name:u().required("Enter name"),price:u().required("Enter price"),desc:u().required("Enter desc"),qty:u().required("Enter qty")}),onSubmit:(s,{resetForm:c})=>{if(r){const a=new FormData;for(const t in s)t!=="hero"&&a.append(t,s[t]);for(const t of o)a.append("remove",t);for(const t of s.hero)a.append("hero",t);F({_id:r._id,fd:a}),h(null)}else{const a=new FormData;for(const t in s)t!=="hero"&&a.append(t,s[t]);for(const t of s.hero)a.append("hero",t);v(a)}p([]),c()}}),l=s=>B({"form-control my-2":!0,"is-invalid":n.touched[s]&&n.errors[s],"is-valid":n.touched[s]&&!n.errors[s]});return i.useEffect(()=>{b&&x.success("product create success")},[b]),i.useEffect(()=>{P&&x.success("product remmove success")},[P]),i.useEffect(()=>{N&&x.success("product update success")},[N]),e.jsxs(H,{children:[S||q||w?e.jsxs(e.Fragment,{children:["Please wait... ",e.jsx(M,{})]}):e.jsxs(j,{children:[e.jsx(j.Header,{children:"Products"}),e.jsx(j.Body,{children:e.jsxs("form",{onSubmit:n.handleSubmit,children:[e.jsx(m,{className:l("name"),placeholder:"enter name",...n.getFieldProps("name")}),e.jsx(m,{type:"number",placeholder:"enter price",className:l("price"),...n.getFieldProps("price")}),e.jsx(m,{type:"text",placeholder:"enter desc",className:l("desc"),...n.getFieldProps("desc")}),e.jsx(m,{className:l("qty"),...n.getFieldProps("qty"),type:"number",placeholder:"enter qty"}),r?e.jsxs(e.Fragment,{children:[r.hero.map(s=>e.jsx("div",{children:e.jsxs("div",{className:`${o.includes(s)&&"border border-danger my-2"} d-flex justify-content-between align-items-center px-4`,children:[e.jsx("img",{src:s,height:50,className:"me-2 rounded-3",alt:""}),o.includes(s)?e.jsx(d,{onClick:()=>g(o.filter(c=>c!==s)),variant:"dark",children:"Cancel"}):e.jsx(d,{variant:"danger",onClick:c=>{o.includes(s)||g([...o,s])},children:"Remove"})]})})),C?e.jsxs(e.Fragment,{children:[e.jsx(m,{type:"file",placeholder:"enter hero",multiple:!0,className:l("hero"),onChange:s=>{const c=[];for(const a of s.target.files)c.push(URL.createObjectURL(a));p(c),n.setFieldValue("hero",s.target.files)}}),e.jsx(d,{onClick:s=>f(!1),variant:"dark",className:"my-3",children:"cancel"}),"                                  "]}):e.jsx(d,{onClick:s=>f(!0),className:"my-3",children:"Add New Image"})]}):e.jsx(m,{type:"file",placeholder:"enter hero",multiple:!0,className:l("hero"),onChange:s=>{const c=[];for(const a of s.target.files)c.push(URL.createObjectURL(a));p(c),n.setFieldValue("hero",s.target.files)}}),E.map(s=>e.jsx("img",{src:s,height:50,alt:""})),r?e.jsxs(e.Fragment,{children:[e.jsx(d,{type:"submit",variant:"warning",className:"w-100 btn-lg",children:"update Product"}),e.jsx(d,{type:"button",onClick:()=>h(null),variant:"outline-dark",className:"w-100 btn-lg mt-3",children:"Cancel"})]}):e.jsx(d,{type:"submit",className:"w-100 btn-lg",children:"Add Product"})]})})]}),e.jsxs("table",{class:"table table-dark table-striped table-hover",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"name"}),e.jsx("th",{children:"desc"}),e.jsx("th",{children:"price"}),e.jsx("th",{children:"gty"}),e.jsx("th",{children:"hero"}),e.jsx("th",{children:"actions"})]})}),e.jsx("tbody",{children:y&&y.result.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:s.name}),e.jsx("td",{children:s.desc}),e.jsx("td",{children:s.price}),e.jsx("td",{children:s.qty}),e.jsx("td",{children:s.hero.map(c=>e.jsx("img",{src:c,height:50,className:"mx-2 rounded"}))}),e.jsxs("td",{children:[e.jsx(d,{onClick:()=>h(s),className:"me-2",variant:"warning",children:"Edit"}),e.jsx(d,{onClick:()=>k(s._id),className:"me-2",variant:"danger",children:"Remove"})]})]},s._id))})]})]})};export{X as default};
